- hosts: localhost
  gather_facts: false
  tasks:
    - ansible.builtin.copy:
        src: tf
        dest: /tmp

    - ansible.builtin.tempfile:
        suffix: .tfplan
      register: plan_file

    - cloud.terraform.plan_stash:
        path: "{{ plan_file.path }}"
        state: load
      no_log: true

    - cloud.terraform.terraform:
        force_init: true
        project_path: /tmp/tf
        plan_file: "{{ plan_file.path }}"

    - debug:
        msg: "{{ lookup('ansible.builtin.file', '/tmp/test') }}"
